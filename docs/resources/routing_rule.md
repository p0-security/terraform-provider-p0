---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "p0_routing_rule Resource - p0"
subcategory: ""
description: |-
  A routing rule that controls who can request access to what, and access requirements.
  See the P0 request-routing docs https://docs.p0.dev/just-in-time-access/request-routing.
---

# p0_routing_rule (Resource)

A routing rule that controls who can request access to what, and access requirements.
See [the P0 request-routing docs](https://docs.p0.dev/just-in-time-access/request-routing).

## Example Usage

```terraform
resource "p0_routing_rule" "example" {
  requestor = {
    type = "group"
    groups = [{
      directory = "okta"
      id        = "00abcdefghijklmno697"
      label     = "AWS Developers"
    }]
  }
  resource = {
    type    = "integration"
    service = "aws"
    filters = {
      "tag" = {
        effect  = "keep"
        key     = "p0_grantable"
        pattern = "1|true"
      }
    }
  }
  approval = [{
    type        = "auto"
    integration = "pagerduty"
    options = {
      require_reason = true
    }
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `approval` (Attributes List) Determines access requirements. See [the Approval docs](https://docs.p0.dev/just-in-time-access/request-routing#approval). (see [below for nested schema](#nestedatt--approval))
- `name` (String) The name of the rule
- `requestor` (Attributes) Controls who has access. See [the Requestor docs](https://docs.p0.dev/just-in-time-access/request-routing#requestor). (see [below for nested schema](#nestedatt--requestor))
- `resource` (Attributes) Controls what is accessed. See [the Resource docs](https://docs.p0.dev/just-in-time-access/request-routing#resource). (see [below for nested schema](#nestedatt--resource))

<a id="nestedatt--approval"></a>
### Nested Schema for `approval`

Required:

- `type` (String) Determines trust requirements for access. If empty, access is disallowed. Except for 'deny', meeting any requirement is sufficient to grant access. Possible values:
    - 'auto': Access is granted according to the requirements of the specified 'integration'
    - 'deny': Access is always denied
    - 'escalation': Access may be approved by on-call members of the specified services, who are paged when access is manually escalated by the requestor
    - 'group': Access may be granted by any member of the defined directory group
    - 'persistent': Access is always granted
    - 'requestor-profile': Allows approval by a user specified by a field in the requestor's IDP profile
    - 'p0': Access may be granted by any user with the P0 "approver" role (defined in the P0 app)

Optional:

- `directory` (String) May only be used if 'type' is 'requestor-profile'. One of "azure-ad", "okta", or "workspace".
- `effect` (String) The filter effect. May be one of:
	 - 'keep': Access rule only applies when a requestor is a member of any of the specified groups
	 - 'remove': Access rule only applies when a requestor is _not_ a member of any of the specified groups
- `groups` (Attributes List) May only be used if 'type' is 'group'. If the user is a member of any of these groups, the rule will match. (see [below for nested schema](#nestedatt--approval--groups))
- `integration` (String) May only be used if 'type' is 'auto' or 'escalation'. Possible values:
- 'pagerduty': Access is granted if the requestor is on-call.
- `options` (Attributes) If present, determines additional trust requirements. (see [below for nested schema](#nestedatt--approval--options))
- `profile_property` (String) May only be used if 'type' is 'requestor-profile'. This is the profile attribute that contains the manager's email.
- `services` (List of String) May only be used if 'type' is 'escalation'. Defines which services to page on escalation.

<a id="nestedatt--approval--groups"></a>
### Nested Schema for `approval.groups`

Required:

- `directory` (String) One of "azure-ad", "okta", or "workspace".
- `id` (String) This is the directory's internal group identifier.

Optional:

- `label` (String) This is any human-readable name for the directory group specified in the 'id' attribute.


<a id="nestedatt--approval--options"></a>
### Nested Schema for `approval.options`

Optional:

- `allow_one_party` (Boolean) If true, allows requestors to approve their own requests.
- `require_reason` (Boolean) If true, requires access requests to include a reason.



<a id="nestedatt--requestor"></a>
### Nested Schema for `requestor`

Required:

- `type` (String) How P0 matches requestors:
    - 'any': Any requestor will match
    - 'group': Members of a directory group will match
    - 'user': Only match a single user

Optional:

- `effect` (String) The filter effect. May be one of:
	 - 'keep': Access rule only applies when a requestor is a member of any of the specified groups
	 - 'remove': Access rule only applies when a requestor is _not_ a member of any of the specified groups
- `groups` (Attributes List) May only be used if 'type' is 'group'. If the user is a member of any of these groups, the rule will match. (see [below for nested schema](#nestedatt--requestor--groups))
- `uid` (String) May only be used if 'type' is 'user'. This is the user's email address.

<a id="nestedatt--requestor--groups"></a>
### Nested Schema for `requestor.groups`

Required:

- `directory` (String) One of "azure-ad", "okta", or "workspace".
- `id` (String) This is the directory's internal group identifier.

Optional:

- `label` (String) This is any human-readable name for the directory group specified in the 'id' attribute.



<a id="nestedatt--resource"></a>
### Nested Schema for `resource`

Required:

- `type` (String) How P0 matches resources:
    - 'any': Any resource
    - 'integration': Only resources within a specified integration

Optional:

- `filters` (Attributes Map) May only be used if 'type' is 'integration'. Available filters depend on the value of 'service'.
See [the Resource docs](https://docs.p0.dev/just-in-time-access/request-routing#resource) for a list of available filters. (see [below for nested schema](#nestedatt--resource--filters))
- `service` (String) May only be used if 'type' is 'integration'.
See [the Resource docs](https://docs.p0.dev/just-in-time-access/request-routing#resource) for a list of available services.

<a id="nestedatt--resource--filters"></a>
### Nested Schema for `resource.filters`

Required:

- `effect` (String) The filter effect. May be one of:
    - 'keep': Access rule only applies to items matching this filter
    - 'remove': Access rule only applies to items _not_ matching this filter
    - 'removeAll': Access rule does not apply to any item with this filter key

Optional:

- `key` (String) The value being filtered. Required if the filter effect is 'keep' or 'remove'.
See [docs](https://docs.p0.dev/just-in-time-access/request-routing#resource) for available values.
- `pattern` (String) Filter patterns. Patterns are unanchored.
- `value` (Boolean) The value being filtered. Required if it's a boolean filter.
