---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "p0_gcp_sharing_restriction Resource - p0"
subcategory: ""
description: |-
  Validates installation of a domain-restricted sharing policy, preventing privilege
  escalation via the P0 IAM-management integration.
  To use this resource, you must:
  install the p0_gcp_iam_write resource, andcreate a domain-restricted-sharing organization policy
  P0 recommends defining this infrastructure according to the pattern in the example usage.
---

# p0_gcp_sharing_restriction (Resource)

Validates installation of a domain-restricted sharing policy, preventing privilege
escalation via the P0 IAM-management integration.

To use this resource, you must:
- install the `p0_gcp_iam_write` resource, and
- create a domain-restricted-sharing organization policy

P0 recommends defining this infrastructure according to the pattern in the example usage.

## Example Usage

```terraform
resource "p0_gcp" "example" {
  organization_id = "123456789012"
}

# Follow instructions for creating Terraform for IAM management in p0_gcp_iam_write documentation
# ...

resource "p0_gcp_iam_write" "example" {
  project = locals.project
  depends_on = [
    google_project_iam_member.example_custom_role,
    google_project_iam_member.example_predefined_role
  ]
}

# Prevents P0 from assigning grants outside your domain
resource "google_org_policy_policy" "example" {
  name   = "projects/my_project/policies/iam.allowedPolicyMemberDomains"
  parent = "projects/my_project"

  spec {
    rules {
      values {
        allowed_values = [
          "is:principalSet://iam.googleapis.com/organizations/${p0_gcp.example.organization_id}"
        ]
      }
    }
  }
}

# Finish the P0 sharing-restriction installation
resource "p0_gcp_sharing_restriction" "example" {
  project = p0_gcp_iam_write.example.project
  depends_on = [
    google_org_policy_policy.example
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `project` (String) The ID of the Google Cloud project to manage with P0

### Read-Only

- `state` (String) This item's install progress in the P0 application:
	- 'stage': The item has been staged for installation
	- 'configure': The item is available to be added to P0, and may be configured
	- 'installed': The item is fully installed
