---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "p0_gcp_iam_write Resource - p0"
subcategory: ""
description: |-
  An installation of P0, on a single Google Cloud project, for IAM management.
  To use this resource, you must also:
  install the p0_gcp_iam_write_staged resourcecreate a custom role allowing IAM-management operations,grant this custom role to P0's service account,grant the iam.securityAdmin role to P0's service account.
  Use the read-only attributes defined on p0_gcp_iam_write_staged to create the requisite Google Cloud infrastructure.
  See the example usage for the recommended pattern to define this infrastructure.
---

# p0_gcp_iam_write (Resource)

An installation of P0, on a single Google Cloud project, for IAM management.

To use this resource, you must also:
- install the `p0_gcp_iam_write_staged` resource
- create a custom role allowing IAM-management operations,
- grant this custom role to P0's service account,
- grant the `iam.securityAdmin` role to P0's service account.

Use the read-only attributes defined on `p0_gcp_iam_write_staged` to create the requisite Google Cloud infrastructure.

See the example usage for the recommended pattern to define this infrastructure.

## Example Usage

```terraform
resource "p0_gcp" "example" {
  organization_id = "123456789012"
}

locals {
  project = "my_project_id"
}

resource "p0_gcp_iam_write_staged" "example" {
  project    = locals.project
  depends_on = [p0_gcp.example]
}

# This custom role is required for P0 to manage IAM grants in your project
resource "google_project_iam_custom_role" "example" {
  project     = locals.project
  role_id     = p0_gcp_iam_write_staged.example.custom_role.id
  title       = p0_gcp_iam_write_staged.example.custom_role.name
  description = "Integration role for P0 IAM management integration"
  permissions = p0_gcp_iam_write_staged.example.permissions
}

resource "google_project_iam_member" "example_custom_role" {
  project = locals.project
  role    = google_project_iam_custom_role.example.id
  member  = "serviceAccount:${p0_gcp.example.service_account_email}"
}

# The predefined role is required for P0 to grant resource-level access in your project
resource "google_project_iam_member" "example_predefined_role" {
  project = locals.project
  role    = p0_gcp_iam_write_staged.example.predefined_role
  member  = "serviceAccount:${p0_gcp.example.service_account_email}"
}

# The `p0_gcp_iam_write` resource will fail to validate unless it is installed
# _after_ the P0 service account is granted the above roles
resource "p0_gcp_iam_write" "example" {
  project = locals.project
  depends_on = [
    google_project_iam_member.example_custom_role,
    google_project_iam_member.example_predefined_role
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `project` (String) The ID of the Google Cloud project to manage with P0

### Read-Only

- `state` (String) This item's install progress in the P0 application:
	- 'stage': The item has been staged for installation
	- 'configure': The item is available to be added to P0, and may be configured
	- 'installed': The item is fully installed
