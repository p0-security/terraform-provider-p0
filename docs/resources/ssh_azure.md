---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "p0_ssh_azure Resource - p0"
subcategory: ""
description: |-
  A Microsoft Azure SSH installation.
  Installing SSH allows you to manage access to your virtual machines on Microsoft Azure.
---

# p0_ssh_azure (Resource)

A Microsoft Azure SSH installation. 
		
Installing SSH allows you to manage access to your virtual machines on Microsoft Azure.

## Example Usage

```terraform
locals {
  management_group_id = "my-management-group"
  subscription_id     = "12345678-1234-1234-1234-123456789012"
  bastion_id          = "/subscriptions/12345678-1234-1234-1234-123456789012/resourceGroups/sample-resource-group/providers/Microsoft.Network/bastionHosts/sample-bastion"

}

provider "azurerm" {
  features {}
  subscription_id = local.subscription_id
}

resource "azurerm_role_definition" "vm_admin_access" {
  name        = "Virtual Machine Administrator Access"
  scope       = "/providers/Microsoft.Management/managementGroups/${local.management_group_id}"
  description = "Grants a user read access to virtual machines and Sudo SSH access"

  permissions {
    actions = [
      "Microsoft.Compute/virtualMachines/read",
      "Microsoft.Network/networkInterfaces/read",
      "Microsoft.Network/bastionHosts/read"
    ]
    data_actions = [
      "Microsoft.Compute/virtualMachines/loginAsAdmin/action",
      "Microsoft.Compute/virtualMachines/login/action"
    ]
  }

  assignable_scopes = [
    "/providers/Microsoft.Management/managementGroups/${local.management_group_id}"
  ]
}

resource "azurerm_role_definition" "vm_standard_access" {
  name        = "Virtual Machine Standard Access"
  scope       = "/providers/Microsoft.Management/managementGroups/${local.management_group_id}"
  description = "Grants a user read access to virtual machines and SSH access"

  permissions {
    actions = [
      "Microsoft.Compute/virtualMachines/read",
      "Microsoft.Network/networkInterfaces/read",
      "Microsoft.Network/bastionHosts/read"
    ]
    data_actions = [
      "Microsoft.Compute/virtualMachines/login/action"
    ]
  }

  assignable_scopes = [
    "/providers/Microsoft.Management/managementGroups/${local.management_group_id}"
  ]
}

resource "p0_ssh_azure" "example" {
  depends_on              = [azurerm_role_definition.vm_admin_access, azurerm_role_definition.vm_standard_access]
  admin_access_role_id    = azurerm_role_definition.vm_admin_access.role_definition_resource_id
  standard_access_role_id = azurerm_role_definition.vm_standard_access.role_definition_resource_id
  is_sudo_enabled         = true
  group_key               = "resource-group"
  bastion_id              = local.bastion_id
  management_group_id     = local.management_group_id
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `admin_access_role_id` (String) The ID of the Azure role that grants admin access to the virtual machines
- `bastion_id` (String) The ID of the Azure Bastion that provides secure RDP and SSH access to the virtual machines
- `management_group_id` (String) The Azure Management Group ID
- `standard_access_role_id` (String) The ID of the Azure role that grants standard access to the virtual machines

### Optional

- `group_key` (String) If present, virtual machines on Azure will be grouped by the value of this tag. Access can be requested, in one request, to all instances with a shared tag value
- `is_sudo_enabled` (Boolean) If true, users will be able to request sudo access to the instances

### Read-Only

- `label` (String) The Azure Management Group label (if available)
- `state` (String) This item's install progress in the P0 application:
	- 'stage': The item has been staged for installation
	- 'configure': The item is available to be added to P0, and may be configured
	- 'installed': The item is fully installed
